@use "@scss/lib/ps-draggable" as *;
@use "@scss/lib/ps-resizable" as *;
@use "@scss/lib/ps-mechanic" as *;

//
@use "@scss/lib/ps-properties" as *;

//
:host(ui-task) {
    @include reset-styles;
    @include ps-properties;

    //
    & {
        --task-size: clamp(32px, 4.2svh, 40px);
        --task-radius: 10px;

        //
        display: inline-grid;
        grid-template-areas: "icon title";
        grid-auto-flow: column;
        grid-template-columns: minmax(var(--task-size), max-content) minmax(0px, 1fr);
        grid-template-rows: minmax(0px, 1fr);

        //
        place-content: center;
        place-items: center;
        inline-size: max-content;
        min-inline-size: calc(var(--task-size) * 1.4);
        min-block-size: var(--task-size);
        padding: 4px 8px;
        gap: 6px;

        //
        color: var(--c2-on-surface(0.0, var(--current)));
        border-radius: var(--task-radius);
        background: color-mix(in oklab, var(--c2-surface(0.0, var(--current)), #0b0b0c) 12%, transparent);
        border: 1px solid color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 10%, transparent);
        box-shadow:
            0 1px 0 color-mix(in oklab, #fff 6%, transparent) inset,
            0 6px 14px -8px color-mix(in oklab, #000 50%, transparent);
        backdrop-filter: blur(6px) saturate(120%);

        //
        cursor: pointer;
        user-select: none;
        touch-action: manipulation;
        transition: transform .18s ease, background-color .18s ease, box-shadow .18s ease, border-color .18s ease;

        //
        -webkit-backdrop-filter: blur(6px) saturate(120%);
        -webkit-tap-highlight-color: transparent;
    }

    /* State */
    &[data-active] {
        background: color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 18%, transparent);
        border-color: color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 40%, transparent);
        box-shadow:
            0 0 0 1px color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 30%, transparent) inset,
            0 10px 24px -14px color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 60%, transparent);
    }

    /* Events */
    &:focus-visible { outline: 2px solid color-mix(in oklab, var(--c2-on-surface(0.0, var(--current)), #ffffff) 70%, transparent); outline-offset: 2px; }
    &:where(:hover) { background: color-mix(in oklab, var(--c2-surface(0.0, var(--current)), #0b0b0c) 18%, transparent); }
    &:active { transform: translateY(1px) scale(.98); }

    /* Children */
    & > .task-icon {
        inline-size: var(--task-size); block-size: var(--task-size);
        & > ui-icon { inline-size: stretch; block-size: stretch; }
    }

    /* Title */
    & > .task-title {
        grid-area: title;
        font: 500 12px/1.2 system-ui, ui-sans-serif;
        opacity: .9;
    }
}
